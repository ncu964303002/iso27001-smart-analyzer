<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISO 27001 æ™ºèƒ½è³‡å®‰äº‹ä»¶åˆ†æå·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            margin-top: 10px;
        }

        .search-section {
            padding: 30px;
            background: #f8f9fa;
        }

        .input-label {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            display: block;
        }

        #searchInput {
            width: 100%;
            padding: 15px 20px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            transition: all 0.3s;
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }

        #searchInput:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .example-section {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            border-left: 3px solid #667eea;
        }

        .example-section h4 {
            font-size: 14px;
            color: #667eea;
            margin-bottom: 8px;
        }

        .example-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .example-tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .example-tag:hover {
            background: #1976d2;
            color: white;
            transform: translateY(-2px);
        }

        .search-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 15px;
        }

        .search-btn:hover:not(:disabled) {
            transform: translateY(-2px);
        }

        .search-btn:active {
            transform: translateY(0);
        }

        .search-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .results {
            padding: 30px;
            display: none;
        }

        .result-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .result-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 20px;
            display: flex;
            align-items: center;
        }

        .result-card h3::before {
            content: '';
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            margin-right: 10px;
        }

        .result-content {
            color: #333;
            line-height: 1.8;
        }

        .result-content ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .result-content li {
            margin-bottom: 8px;
        }

        .result-content p {
            margin-bottom: 10px;
        }

        .incident-title {
            background: #667eea;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            font-size: 22px;
            font-weight: bold;
            text-align: center;
        }

        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: #666;
            font-size: 16px;
        }

        .tag {
            display: inline-block;
            background: #e3f2fd;
            color: #1976d2;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 13px;
            margin-right: 8px;
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 24px;
            }

            .search-section, .results {
                padding: 20px;
            }

            .result-card {
                padding: 20px;
            }

            #searchInput {
                min-height: 80px;
            }
        }

        .char-count {
            text-align: right;
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }

        .severity-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }

        .severity-high {
            background: #ffebee;
            color: #c62828;
        }

        .severity-medium {
            background: #fff3e0;
            color: #e65100;
        }

        .severity-low {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .matched-keywords {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 13px;
        }

        .keyword-chip {
            display: inline-block;
            background: #e0e0e0;
            color: #424242;
            padding: 3px 8px;
            border-radius: 10px;
            margin: 2px;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” ISO 27001 æ™ºèƒ½è³‡å®‰äº‹ä»¶åˆ†æå·¥å…·</h1>
            <p>åŸºæ–¼é—œéµå­—åˆ†æå¼•æ“ï¼Œå³æ™‚è­˜åˆ¥è³‡å®‰é¢¨éšª</p>
            <span class="badge">âš¡ é›¢ç·šå¯ç”¨ Â· å³æ™‚åˆ†æ</span>
        </div>

        <div class="search-section">
            <label class="input-label">è«‹æè¿°æ‚¨é‡åˆ°çš„è³‡å®‰äº‹ä»¶ï¼š</label>
            <textarea 
                id="searchInput" 
                placeholder="ä¾‹å¦‚ï¼š&#10;â€¢ ç™¼ç¾å“¡å·¥åœ¨å…¬å…±å ´æ‰€ä½¿ç”¨å…¬å¸ç­†é›»è™•ç†æ©Ÿå¯†æ–‡ä»¶&#10;â€¢ ç³»çµ±ç®¡ç†å“¡é›¢è·å¾Œä»å¯é ç«¯ç™»å…¥ä¼ºæœå™¨&#10;â€¢ ç™¼ç¾æœªåŠ å¯†çš„å®¢æˆ¶å€‹è³‡å­˜æ”¾åœ¨å…±ç”¨è³‡æ–™å¤¾&#10;&#10;ç³»çµ±æœƒè‡ªå‹•è­˜åˆ¥é—œéµå­—ä¸¦åŒ¹é…ç›¸é—œçš„ ISO 27001 æ¢æ–‡ã€‚"
                maxlength="2000"
            ></textarea>
            <div class="char-count"><span id="charCount">0</span> / 2000</div>

            <div class="example-section">
                <h4>ğŸ’¡ å¸¸è¦‹æƒ…å¢ƒç¯„ä¾‹ï¼ˆé»æ“Šå¿«é€Ÿå¡«å…¥ï¼‰ï¼š</h4>
                <div class="example-tags">
                    <span class="example-tag" onclick="fillExample('ç™¼ç¾å¤šä½å“¡å·¥å…±ç”¨åŒä¸€çµ„ç³»çµ±ç®¡ç†å“¡å¸³è™Ÿå¯†ç¢¼')">å…±ç”¨å¸³è™Ÿå¯†ç¢¼</span>
                    <span class="example-tag" onclick="fillExample('å…¬å¸ç¶²ç«™é­åˆ° SQL Injection æ”»æ“Šï¼Œå®¢æˆ¶è³‡æ–™å¤–æ´©')">SQL Injection æ”»æ“Š</span>
                    <span class="example-tag" onclick="fillExample('å“¡å·¥å°‡åŒ…å«å®¢æˆ¶è³‡æ–™çš„æª”æ¡ˆä¸Šå‚³åˆ°å€‹äºº Google Drive')">è³‡æ–™ä¸Šå‚³é›²ç«¯</span>
                    <span class="example-tag" onclick="fillExample('æ¸…æ½”äººå“¡å¯è‡ªç”±é€²å‡ºæ©Ÿæˆ¿ï¼Œæ²’æœ‰ä»»ä½•ç®¡åˆ¶')">æ©Ÿæˆ¿ç®¡åˆ¶ä¸ç•¶</span>
                    <span class="example-tag" onclick="fillExample('ç™¼ç¾å·²é›¢è· 3 å€‹æœˆçš„å“¡å·¥ VPN å¸³è™Ÿä»ç„¶å¯ä»¥ä½¿ç”¨')">é›¢è·å¸³è™Ÿæœªé—œé–‰</span>
                    <span class="example-tag" onclick="fillExample('ç­†è¨˜å‹é›»è…¦éºå¤±ï¼Œå…§æœ‰æœªåŠ å¯†çš„å°ˆæ¡ˆæ–‡ä»¶')">ç­†é›»éºå¤±</span>
                    <span class="example-tag" onclick="fillExample('USB éš¨èº«ç¢Ÿå¯ä»¥ä»»æ„æ’æ‹”ä½¿ç”¨ï¼Œæ²’æœ‰ç®¡åˆ¶')">USB ç®¡åˆ¶</span>
                    <span class="example-tag" onclick="fillExample('ä¼ºæœå™¨å·²ç¶“å…©å¹´æ²’æœ‰å®‰è£å®‰å…¨æ€§æ›´æ–°')">ç³»çµ±æœªæ›´æ–°</span>
                </div>
            </div>

            <button class="search-btn" onclick="analyzeIncident()" id="analyzeBtn">
                ğŸ” é–‹å§‹åˆ†æ
            </button>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <div class="loading-text">æ™ºèƒ½åˆ†æä¸­ï¼Œè«‹ç¨å€™...</div>
        </div>

        <div class="results" id="results"></div>
    </div>

    <script>
        const searchInput = document.getElementById('searchInput');
        const charCount = document.getElementById('charCount');

        searchInput.addEventListener('input', function() {
            charCount.textContent = this.value.length;
        });

        searchInput.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                analyzeIncident();
            }
        });

        function fillExample(text) {
            searchInput.value = text;
            charCount.textContent = text.length;
            searchInput.focus();
        }

        // æ™ºèƒ½è¦å‰‡å¼•æ“ - é—œéµå­—èˆ‡ ISO 27001 æ¢æ–‡å°æ‡‰
        const knowledgeBase = {
            password: {
                keywords: ['å¯†ç¢¼', 'å¸³è™Ÿ', 'èªè­‰', 'ç™»å…¥', 'å…±ç”¨å¸³è™Ÿ', 'é è¨­å¯†ç¢¼', 'å¼±å¯†ç¢¼'],
                iso: ['A.5.17 èªè­‰è³‡è¨Š', 'A.5.18 å­˜å–æ¬Šé™'],
                risks: [
                    'æœªæˆæ¬Šäººå“¡å¯èƒ½å–å¾—ç³»çµ±å­˜å–æ¬Šé™',
                    'ç„¡æ³•è¿½è¹¤å€‹äººæ“ä½œè¡Œç‚ºèˆ‡è²¬ä»»æ­¸å±¬',
                    'å¯†ç¢¼å¤–æ´©é¢¨éšªå¢åŠ ï¼Œå¯èƒ½å°è‡´å¤§è¦æ¨¡è³‡æ–™å¤–æ´©',
                    'é•åæœ€å°æ¬Šé™åŸå‰‡ï¼Œæ¬Šé™ç®¡ç†å¤±æ§'
                ],
                measures: [
                    'å¯¦æ–½å¯†ç¢¼è¤‡é›œåº¦æ”¿ç­–ï¼ˆè‡³å°‘12å­—å…ƒï¼ŒåŒ…å«å¤§å°å¯«ã€æ•¸å­—ã€ç¬¦è™Ÿï¼‰',
                    'å»ºç«‹å¯†ç¢¼å®šæœŸæ›´æ›æ©Ÿåˆ¶ï¼ˆä¸€èˆ¬å¸³è™Ÿ90å¤©ã€ç‰¹æ¬Šå¸³è™Ÿ60å¤©ï¼‰',
                    'éƒ¨ç½²å¤šå› ç´ èªè­‰(MFA)ï¼Œç‰¹åˆ¥é‡å°ç‰¹æ¬Šå¸³è™Ÿèˆ‡é ç«¯å­˜å–',
                    'ç¦æ­¢å¸³è™Ÿå…±ç”¨ï¼Œæ¯äººå¿…é ˆä½¿ç”¨å€‹äººå°ˆå±¬å¸³è™Ÿ',
                    'ä½¿ç”¨å¯†ç¢¼ç®¡ç†å·¥å…·æˆ–å–®ä¸€ç™»å…¥(SSO)ç³»çµ±',
                    'å®šæœŸé€²è¡Œå¸³è™Ÿæ¬Šé™å¯©æŸ¥'
                ],
                severity: 'é«˜'
            },
            access: {
                keywords: ['æ¬Šé™', 'å­˜å–', 'æˆæ¬Š', 'é›¢è·', 'è·å‹™ç•°å‹•', 'ç‰¹æ¬Š', 'ç®¡ç†å“¡'],
                iso: ['A.5.18 å­˜å–æ¬Šé™', 'A.8.2 ç‰¹æ¬Šå­˜å–æ¬Šé™', 'A.6.4 é›¢è·æˆ–è®Šæ›´åƒ±ç”¨'],
                risks: [
                    'é›¢è·æˆ–ç•°å‹•äººå“¡ä»ä¿æœ‰ä¸ç•¶å­˜å–æ¬Šé™',
                    'æ¬Šé™ç´¯ç©å°è‡´é•åæœ€å°æ¬Šé™åŸå‰‡',
                    'ç‰¹æ¬Šå¸³è™Ÿæ¿«ç”¨å¯èƒ½é€ æˆç³»çµ±æ€§ç ´å£',
                    'å…§éƒ¨å¨è„…é¢¨éšªå¢åŠ ï¼Œå¯èƒ½ç«Šå–æˆ–ç ´å£è³‡æ–™'
                ],
                measures: [
                    'å»ºç«‹å­˜å–æ¬Šé™å®šæœŸå¯©æŸ¥æ©Ÿåˆ¶ï¼ˆè‡³å°‘æ¯å­£ä¸€æ¬¡ï¼‰',
                    'å¯¦æ–½è§’è‰²åŸºç¤å­˜å–æ§åˆ¶(RBAC)',
                    'é›¢è·ç•¶æ—¥ç«‹å³æ’¤éŠ·æ‰€æœ‰ç³»çµ±å­˜å–æ¬Šé™',
                    'è·å‹™ç•°å‹•æ™‚å³æ™‚èª¿æ•´æ¬Šé™ï¼Œç§»é™¤ä¸å¿…è¦æ¬Šé™',
                    'ç‰¹æ¬Šå¸³è™Ÿå¯¦æ–½é›™äººæˆæ¬Šæ©Ÿåˆ¶',
                    'è¨˜éŒ„æ‰€æœ‰ç‰¹æ¬Šæ“ä½œä¸¦å®šæœŸå¯©æŸ¥',
                    'ä½¿ç”¨ç‰¹æ¬Šå¸³è™Ÿç®¡ç†ç³»çµ±(PAM)'
                ],
                severity: 'é«˜'
            },
            encryption: {
                keywords: ['åŠ å¯†', 'æœªåŠ å¯†', 'æ˜æ–‡', 'å‚³è¼¸', 'https', 'ssl', 'tls', 'æ©Ÿå¯†', 'æ•æ„Ÿ'],
                iso: ['A.8.24 å¯†ç¢¼å­¸ä½¿ç”¨', 'A.5.10 è³‡è¨ŠåŠå…¶ä»–ç›¸é—œè³‡ç”¢ä¹‹å¯æ¥å—ä½¿ç”¨'],
                risks: [
                    'è³‡æ–™å‚³è¼¸æˆ–å„²å­˜éç¨‹ä¸­å¯èƒ½è¢«ç«Šè½æˆ–ç«Šå–',
                    'ä¸­é–“äººæ”»æ“Š(MITM)é¢¨éšª',
                    'é•åå€‹è³‡æ³•ã€GDPRç­‰æ³•è¦è¦æ±‚',
                    'æ©Ÿå¯†è³‡è¨Šå¤–æ´©å°è‡´å•†æ¥­æå¤±æˆ–æ³•å¾‹è²¬ä»»'
                ],
                measures: [
                    'æ‰€æœ‰ç¶²ç«™å¼·åˆ¶ä½¿ç”¨ HTTPS (TLS 1.2 ä»¥ä¸Š)',
                    'æ•æ„Ÿè³‡æ–™å¿…é ˆåŠ å¯†å„²å­˜ï¼ˆAES-256æˆ–ä»¥ä¸Šï¼‰',
                    'è³‡æ–™åº«é€£ç·šä½¿ç”¨åŠ å¯†é€šé“',
                    'ç¦ç”¨ä¸å®‰å…¨å”å®šï¼ˆHTTPã€FTPã€Telnetï¼‰',
                    'ç­†è¨˜å‹é›»è…¦èˆ‡è¡Œå‹•è£ç½®å•Ÿç”¨å…¨ç£ç¢ŸåŠ å¯†',
                    'å¯¦æ–½é‡‘é‘°ç®¡ç†æ”¿ç­–ï¼Œå®šæœŸè¼ªæ›åŠ å¯†é‡‘é‘°',
                    'é›»å­éƒµä»¶å‚³è¼¸å•Ÿç”¨ TLS åŠ å¯†'
                ],
                severity: 'é«˜'
            },
            backup: {
                keywords: ['å‚™ä»½', 'é‚„åŸ', 'å¾©åŸ', 'å‹’ç´¢', 'è³‡æ–™éºå¤±'],
                iso: ['A.8.13 è³‡è¨Šå‚™ä»½', 'A.8.14 è³‡è¨Šç³»çµ±å‚™æ´'],
                risks: [
                    'ç¡¬é«”æ•…éšœæˆ–ç½é›£å°è‡´è³‡æ–™æ°¸ä¹…éºå¤±',
                    'å‹’ç´¢è»Ÿé«”æ”»æ“Šæ™‚ç„¡æ³•å¾©åŸè³‡æ–™',
                    'æ¥­å‹™ä¸­æ–·æ™‚é–“éé•·ï¼Œé€ æˆç‡Ÿé‹æå¤±',
                    'é•åæ³•è¦å°è³‡æ–™ä¿å­˜çš„è¦æ±‚'
                ],
                measures: [
                    'å¯¦æ–½ 3-2-1 å‚™ä»½ç­–ç•¥ï¼ˆ3ä»½å‰¯æœ¬ã€2ç¨®åª’é«”ã€1ä»½ç•°åœ°ï¼‰',
                    'å»ºç«‹è‡ªå‹•åŒ–å‚™ä»½æ’ç¨‹ï¼ˆæ¯æ—¥å¢é‡ã€æ¯é€±å®Œæ•´å‚™ä»½ï¼‰',
                    'å®šæœŸæ¸¬è©¦å‚™ä»½é‚„åŸç¨‹åºï¼ˆè‡³å°‘æ¯å­£ä¸€æ¬¡ï¼‰',
                    'å‚™ä»½è³‡æ–™å¿…é ˆåŠ å¯†ä¿è­·',
                    'ç•°åœ°å‚™ä»½æˆ–é›²ç«¯å‚™ä»½ï¼Œé˜²ç¯„å¯¦é«”ç½é›£',
                    'å»ºç«‹å‚™ä»½ä¿å­˜æœŸé™æ”¿ç­–',
                    'ç›£æ§å‚™ä»½ä½œæ¥­æˆåŠŸç‡ä¸¦è¨­å®šå‘Šè­¦'
                ],
                severity: 'é«˜'
            },
            physical: {
                keywords: ['æ©Ÿæˆ¿', 'é–€ç¦', 'ç›£è¦–', 'å¯¦é«”', 'é€²å‡º', 'è¨ªå®¢', 'æ¸…æ½”', 'éºå¤±', 'ç«Šå–'],
                iso: ['A.7.2 å¯¦é«”é€²å…¥æ§ç®¡', 'A.7.4 å¯¦é«”å®‰å…¨ç›£è¦–'],
                risks: [
                    'æœªæˆæ¬Šäººå“¡é€²å…¥æ©Ÿæˆ¿æˆ–è¾¦å…¬å€åŸŸ',
                    'è¨­å‚™é­ç«Šæˆ–è“„æ„ç ´å£',
                    'å¯¦é«”åª’é«”ï¼ˆæ–‡ä»¶ã€ç¡¬ç¢Ÿï¼‰éºå¤±æˆ–ç«Šå–',
                    'ç„¡æ³•è¿½è¹¤é€²å‡ºè¨˜éŒ„èˆ‡äº‹ä»¶èª¿æŸ¥'
                ],
                measures: [
                    'å®‰è£é–€ç¦åˆ·å¡ç³»çµ±ï¼Œé™åˆ¶æ©Ÿæˆ¿èˆ‡é‡è¦å€åŸŸé€²å‡º',
                    'éƒ¨ç½² 24/7 ç›£è¦–æ”å½±æ©Ÿä¸¦ä¿å­˜éŒ„å½±è¨˜éŒ„',
                    'å»ºç«‹è¨ªå®¢ç™»è¨˜èˆ‡é™ªåŒåˆ¶åº¦',
                    'å¯¦æ–½æ¸…æ¡Œæ”¿ç­–ï¼Œæ•æ„Ÿæ–‡ä»¶ä¸å¾—æ”¾ç½®æ¡Œé¢',
                    'è¨­å‚™å ±å»¢å‰å¿…é ˆé€²è¡Œè³‡æ–™éŠ·æ¯€ï¼ˆæ¶ˆç£æˆ–ç‰©ç†ç ´å£ï¼‰',
                    'ç­†è¨˜å‹é›»è…¦ä½¿ç”¨é–éˆå›ºå®šæˆ–é–æ«ƒä¿ç®¡',
                    'å®šæœŸå¯©æŸ¥é€²å‡ºè¨˜éŒ„'
                ],
                severity: 'ä¸­'
            },
            network: {
                keywords: ['é˜²ç«ç‰†', 'ç¶²è·¯', 'æ”»æ“Š', 'ddos', 'å…¥ä¾µ', 'å°åŒ…', 'æµé‡', 'vpn', 'é ç«¯'],
                iso: ['A.8.20 ç¶²è·¯å®‰å…¨', 'A.8.21 ç¶²è·¯æœå‹™å®‰å…¨', 'A.6.7 é è·å·¥ä½œ'],
                risks: [
                    'ç¶²è·¯æ”»æ“Šç›´æ¥é€²å…¥å…§éƒ¨ç¶²è·¯',
                    'DDoS æ”»æ“Šå°è‡´æœå‹™ä¸­æ–·',
                    'ç„¡æ³•ç›£æ§èˆ‡é˜»æ“‹æƒ¡æ„æµé‡',
                    'é ç«¯é€£ç·šæœªåŠ å¯†ï¼Œè³‡æ–™å¯èƒ½è¢«ç«Šè½'
                ],
                measures: [
                    'éƒ¨ç½²æ–°ä¸–ä»£é˜²ç«ç‰†(NGFW)èˆ‡å…¥ä¾µé˜²ç¦¦ç³»çµ±(IPS)',
                    'å¯¦æ–½ç¶²è·¯åˆ†æ®µ(Network Segmentation)éš”é›¢é‡è¦ç³»çµ±',
                    'å»ºç«‹ DMZ å€åŸŸéš”é›¢å°å¤–æœå‹™',
                    'é ç«¯é€£ç·šå¼·åˆ¶ä½¿ç”¨ VPN ä¸¦å•Ÿç”¨ MFA',
                    'å®šæœŸå¯©æŸ¥èˆ‡æ›´æ–°é˜²ç«ç‰†è¦å‰‡',
                    'éƒ¨ç½² DDoS é˜²è­·æœå‹™',
                    'ç›£æ§ç¶²è·¯æµé‡ç•°å¸¸ä¸¦è¨­å®šå‘Šè­¦'
                ],
                severity: 'é«˜'
            },
            patch: {
                keywords: ['æ›´æ–°', 'ä¿®è£œ', 'æ¼æ´', 'å¼±é»', 'ç‰ˆæœ¬', 'éæœŸ', 'æœªæ›´æ–°'],
                iso: ['A.8.8 æŠ€è¡“å¼±é»ç®¡ç†'],
                risks: [
                    'å·²çŸ¥æ¼æ´æœªä¿®è£œï¼Œæ˜“é­å—æ”»æ“Šåˆ©ç”¨',
                    'é›¶æ™‚å·®æ”»æ“Šé¢¨éšªå¢åŠ ',
                    'ç³»çµ±ç©©å®šæ€§èˆ‡æ•ˆèƒ½ä¸‹é™',
                    'ç„¡æ³•æŠµç¦¦æœ€æ–°å¨è„…èˆ‡æ”»æ“Šæ‰‹æ³•'
                ],
                measures: [
                    'å»ºç«‹ä¿®è£œç¨‹å¼ç®¡ç†æµç¨‹èˆ‡æ’ç¨‹',
                    'æ¯é€±é€²è¡Œè‡ªå‹•åŒ–æ¼æ´æƒæ',
                    'é—œéµæ¼æ´ï¼ˆCVSS 9.0ä»¥ä¸Šï¼‰å¿…é ˆåœ¨72å°æ™‚å…§ä¿®è£œ',
                    'å»ºç«‹æ¸¬è©¦ç’°å¢ƒé©—è­‰æ›´æ–°ï¼Œé¿å…å½±éŸ¿æ­£å¼ç³»çµ±',
                    'è¨‚é–±å» å•†å®‰å…¨å…¬å‘Šèˆ‡å¨è„…æƒ…å ±',
                    'è¨˜éŒ„æ‰€æœ‰æ›´æ–°èˆ‡ä¿®è£œä½œæ¥­',
                    'ç„¡æ³•æ›´æ–°çš„ç³»çµ±é€²è¡Œç¶²è·¯éš”é›¢æˆ–é¡å¤–é˜²è­·'
                ],
                severity: 'é«˜'
            },
            usb: {
                keywords: ['usb', 'éš¨èº«ç¢Ÿ', 'å¤–æ¥', 'å„²å­˜è£ç½®', 'æŠ½å–å¼'],
                iso: ['A.8.1 ä½¿ç”¨è€…ç«¯é»è£ç½®', 'A.7.7 æ¸…æ¡Œèˆ‡æ¸…è¢å¹•'],
                risks: [
                    'æƒ¡æ„è»Ÿé«”é€é USB å‚³æ’­ï¼ˆå¦‚å‹’ç´¢è»Ÿé«”ï¼‰',
                    'æ•æ„Ÿè³‡æ–™è¢«éæ³•è¤‡è£½å¤–æ´©',
                    'å¼•å…¥æœªç¶“æˆæ¬Šè»Ÿé«”é€ æˆç³»çµ±æ¼æ´',
                    'USB è£ç½®éºå¤±å°è‡´è³‡æ–™å¤–æ´©'
                ],
                measures: [
                    'å¯¦æ–½ USB è£ç½®ç™½åå–®ç®¡ç†',
                    'éƒ¨ç½²ç«¯é»é˜²è­·ç³»çµ±(DLP)ç›£æ§è³‡æ–™å‚³è¼¸',
                    'USB åŸ å¯¦é«”å°é–æˆ–è»Ÿé«”æ§åˆ¶',
                    'æ‰€æœ‰å¤–éƒ¨å„²å­˜è£ç½®å¿…é ˆåŠ å¯†',
                    'å»ºç«‹å¯æ”œå¼è£ç½®ä½¿ç”¨æ”¿ç­–èˆ‡ç”³è«‹æµç¨‹',
                    'å®šæœŸç¨½æ ¸ USB ä½¿ç”¨è¨˜éŒ„',
                    'å“¡å·¥è³‡å®‰æ„è­˜è¨“ç·´ï¼Œç¦ç”¨ä¾†è·¯ä¸æ˜çš„ USB'
                ],
                severity: 'ä¸­'
            },
            cloud: {
                keywords: ['é›²ç«¯', 'cloud', 'google drive', 'dropbox', 'onedrive', 'saas', 'iaas'],
                iso: ['A.5.23 é›²ç«¯æœå‹™ä½¿ç”¨ä¹‹è³‡è¨Šå®‰å…¨'],
                risks: [
                    'å½±å­ITå•é¡Œï¼Œæœªç¶“æ ¸å‡†ä½¿ç”¨é›²ç«¯æœå‹™',
                    'è³‡æ–™å„²å­˜ä½ç½®ä¸æ˜ç¢ºï¼Œå¯èƒ½é•åæ³•è¦',
                    'é›²ç«¯æœå‹™å­˜å–æ§åˆ¶ä¸ç•¶',
                    'ç¬¬ä¸‰æ–¹æœå‹™å•†è³‡å®‰äº‹ä»¶å½±éŸ¿æœ¬çµ„ç¹”'
                ],
                measures: [
                    'å»ºç«‹é›²ç«¯æœå‹™ä½¿ç”¨æ”¿ç­–èˆ‡æ ¸å‡†æ¸…å–®',
                    'éƒ¨ç½²é›²ç«¯å­˜å–å®‰å…¨ä»£ç†(CASB)',
                    'è©•ä¼°é›²ç«¯æœå‹™å•†è³‡å®‰èƒ½åŠ›ï¼ˆè¦æ±‚ ISO 27001 èªè­‰ï¼‰',
                    'æ•æ„Ÿè³‡æ–™ä¸Šå‚³é›²ç«¯å‰å¿…é ˆåŠ å¯†',
                    'å¼·åˆ¶å•Ÿç”¨å¤šå› ç´ èªè­‰(MFA)',
                    'å®šæœŸå¯©æŸ¥é›²ç«¯æœå‹™ä½¿ç”¨ç‹€æ³',
                    'ç¢ºä¿è³‡æ–™å¯æ”œæ€§èˆ‡å¯åˆªé™¤æ€§'
                ],
                severity: 'ä¸­'
            },
            training: {
                keywords: ['è¨“ç·´', 'æ•™è‚²', 'èªçŸ¥', 'æ„è­˜', 'ç¤¾äº¤å·¥ç¨‹', 'é‡£é­š', 'å“¡å·¥'],
                iso: ['A.6.3 è³‡è¨Šå®‰å…¨èªçŸ¥ã€æ•™è‚²åŠè¨“ç·´'],
                risks: [
                    'å“¡å·¥æˆç‚ºè³‡å®‰æœ€å¼±ç’°ç¯€ï¼Œæ˜“å—ç¤¾äº¤å·¥ç¨‹æ”»æ“Š',
                    'ç¶²è·¯é‡£é­šéƒµä»¶é»æ“Šç‡é«˜',
                    'ä¸ç•¶æ“ä½œå°è‡´è³‡å®‰äº‹ä»¶',
                    'ä¸äº†è§£è³‡å®‰æ”¿ç­–èˆ‡è¦ç¯„'
                ],
                measures: [
                    'æ–°é€²å“¡å·¥å¼·åˆ¶é€²è¡Œè³‡å®‰è¨“ç·´',
                    'æ¯å¹´è‡³å°‘èˆ‰è¾¦ 2 æ¬¡å…¨å“¡è³‡å®‰æ•™è‚²è¨“ç·´',
                    'å®šæœŸé€²è¡Œç¶²è·¯é‡£é­šæ¼”ç·´æ¸¬è©¦',
                    'å»ºç«‹è³‡å®‰äº‹ä»¶é€šå ±æ©Ÿåˆ¶èˆ‡è¨“ç·´',
                    'æä¾›ç·šä¸Šå­¸ç¿’å¹³å°èˆ‡è³‡æº',
                    'é‡å°ä¸åŒè§’è‰²è¨­è¨ˆå®¢è£½åŒ–è¨“ç·´èª²ç¨‹',
                    'è¿½è¹¤è¨“ç·´æˆæ•ˆèˆ‡æ¸¬é©—çµæœ'
                ],
                severity: 'ä¸­'
            },
            log: {
                keywords: ['æ—¥èªŒ', 'ç´€éŒ„', 'è¨˜éŒ„', 'log', 'ç¨½æ ¸', 'è»Œè·¡'],
                iso: ['A.8.15 æ—¥èªŒè¨˜éŒ„'],
                risks: [
                    'è³‡å®‰äº‹ä»¶ç„¡æ³•è¿½æŸ¥æ ¹æœ¬åŸå› ',
                    'ç„¡æ³•é€²è¡Œæ•¸ä½é‘‘è­˜èª¿æŸ¥',
                    'ç•°å¸¸è¡Œç‚ºç„¡æ³•åŠæ™‚åµæ¸¬',
                    'æ³•è¦éµå¾ªè¦æ±‚ç„¡æ³•æ»¿è¶³'
                ],
                measures: [
                    'å»ºç«‹é›†ä¸­å¼æ—¥èªŒç®¡ç†ç³»çµ±(SIEM)',
                    'è¨˜éŒ„æ‰€æœ‰é—œéµç³»çµ±èˆ‡æ‡‰ç”¨ç¨‹å¼æ—¥èªŒ',
                    'æ—¥èªŒä¿å­˜è‡³å°‘ 6-12 å€‹æœˆ',
                    'å¯¦æ–½æ—¥èªŒå®Œæ•´æ€§ä¿è­·ï¼Œé˜²æ­¢ç«„æ”¹',
                    'è¨­å®šç•°å¸¸è¡Œç‚ºå‘Šè­¦è¦å‰‡',
                    'å®šæœŸå¯©æŸ¥æ—¥èªŒ',
                    'ç¢ºä¿æ‰€æœ‰ç³»çµ±æ™‚é–“åŒæ­¥(NTP)'
                ],
                severity: 'ä¸­'
            },
            vendor: {
                keywords: ['ä¾›æ‡‰å•†', 'å» å•†', 'å¤–åŒ…', 'ç¬¬ä¸‰æ–¹', 'å§”å¤–', 'åˆç´„'],
                iso: ['A.5.19 ä¾›æ‡‰å•†é—œä¿‚ä¹‹è³‡è¨Šå®‰å…¨', 'A.5.20 ä¾›æ‡‰å•†å”è­°ä¹‹è³‡è¨Šå®‰å…¨'],
                risks: [
                    'ä¾›æ‡‰éˆæ”»æ“Šé¢¨éšª',
                    'ç¬¬ä¸‰æ–¹è³‡å®‰æ¼æ´å½±éŸ¿æœ¬çµ„ç¹”',
                    'è³‡æ–™è™•ç†ä¸ç•¶æˆ–å¤–æ´©',
                    'æœå‹™ä¸­æ–·ç„¡æ‡‰è®Šè¨ˆç•«'
                ],
                measures: [
                    'å»ºç«‹ä¾›æ‡‰å•†è³‡å®‰è©•ä¼°æ©Ÿåˆ¶',
                    'ç°½ç½²è³‡å®‰å”è­°èˆ‡æœå‹™ç­‰ç´šå”è­°(SLA)',
                    'å®šæœŸç¨½æ ¸ä¾›æ‡‰å•†è³‡å®‰ç‹€æ³',
                    'è¦æ±‚ä¾›æ‡‰å•†æä¾›è³‡å®‰è­‰æ˜ï¼ˆå¦‚ ISO 27001ï¼‰',
                    'å»ºç«‹ä¾›æ‡‰å•†åˆ†ç´šç®¡ç†åˆ¶åº¦',
                    'ç°½ç½²è³‡æ–™è™•ç†å”è­°(DPA)æ˜ç¢ºè¦ç¯„è²¬ä»»',
                    'å®šæœŸå¯©æŸ¥ä¾›æ‡‰å•†ç¸¾æ•ˆ'
                ],
                severity: 'ä¸­'
            },
            incident: {
                keywords: ['äº‹ä»¶', 'æ‡‰è®Š', 'æ¼”ç·´', 'é€šå ±', 'ç·Šæ€¥', 'å±æ©Ÿ'],
                iso: ['A.5.24 è³‡è¨Šå®‰å…¨äº‹ä»¶ç®¡ç†è¦åŠƒåŠæº–å‚™', 'A.5.25 è³‡è¨Šå®‰å…¨äº‹ä»¶ä¹‹è©•ä¼°åŠæ±ºç­–'],
                risks: [
                    'äº‹ä»¶ç™¼ç”Ÿæ™‚åæ‡‰æ··äº‚ç„¡ç« æ³•',
                    'æå¤±æ“´å¤§ç„¡æ³•æœ‰æ•ˆæ§åˆ¶',
                    'å¾©åŸæ™‚é–“éé•·å½±éŸ¿æ¥­å‹™',
                    'è­‰æ“šä¿å…¨ä¸ç•¶å½±éŸ¿èª¿æŸ¥'
                ],
                measures: [
                    'å»ºç«‹è³‡å®‰äº‹ä»¶æ‡‰è®Šè¨ˆç•«(IRP)',
                    'æˆç«‹è³‡å®‰äº‹ä»¶æ‡‰è®Šå°çµ„(CSIRT)',
                    'å®šç¾©äº‹ä»¶åˆ†é¡èˆ‡åš´é‡ç­‰ç´š',
                    'å»ºç«‹é€šå ±æµç¨‹èˆ‡è¯çµ¡æ¸…å–®',
                    'å®šæœŸé€²è¡Œæ¡Œé¢æ¼”ç·´èˆ‡å¯¦æˆ°æ¼”ç·´',
                    'æº–å‚™äº‹ä»¶è™•ç†å·¥å…·èˆ‡è¨­å‚™',
                    'å»ºç«‹äº‹ä»¶å¾Œæª¢è¨æ©Ÿåˆ¶',
                    'èˆ‡å¤–éƒ¨è³‡å®‰å» å•†ç°½ç´„æ”¯æ´'
                ],
                severity: 'ä¸­'
            },
            mobile: {
                keywords: ['æ‰‹æ©Ÿ', 'è¡Œå‹•', 'å¹³æ¿', 'byod', 'mdm', 'å€‹äººè£ç½®'],
                iso: ['A.6.7 é è·å·¥ä½œ', 'A.8.1 ä½¿ç”¨è€…ç«¯é»è£ç½®'],
                risks: [
                    'å€‹äººè£ç½®å­˜å–å…¬å¸è³‡æ–™ç„¡ç®¡æ§',
                    'è£ç½®éºå¤±å°è‡´è³‡æ–™å¤–æ´©',
                    'æƒ¡æ„æ‡‰ç”¨ç¨‹å¼æ„ŸæŸ“å…¬å¸ç¶²è·¯',
                    'å·¥ä½œèˆ‡å€‹äººè³‡æ–™æ··ç”¨'
                ],
                measures: [
                    'å¯¦æ–½è¡Œå‹•è£ç½®ç®¡ç†(MDM/EMM)ç³»çµ±',
                    'å»ºç«‹ BYOD æ”¿ç­–èˆ‡ä½¿ç”¨æ¢æ¬¾',
                    'å¼·åˆ¶è£ç½®åŠ å¯†èˆ‡è¢å¹•é–å®š',
                    'éƒ¨ç½²é ç«¯æŠ¹é™¤åŠŸèƒ½',
                    'æ‡‰ç”¨ç¨‹å¼ç™½åå–®æ§åˆ¶',
                    'ç¶²è·¯å­˜å–æ§åˆ¶(NAC)',
                    'å·¥ä½œè³‡æ–™å®¹å™¨åŒ–éš”é›¢'
                ],
                severity: 'ä¸­'
            },
            confidentiality: {
                keywords: ['ä¿å¯†', 'å”è­°', 'nda', 'é›¢è·', 'æ´©å¯†', 'å•†æ¥­æ©Ÿå¯†'],
                iso: ['A.6.1 ç¯©é¸', 'A.6.6 ä¿å¯†æˆ–ä¸æ­éœ²å”è­°'],
                risks: [
                    'æ©Ÿå¯†è³‡è¨Šå¤–æ´©ç¼ºä¹æ³•å¾‹ç´„æŸ',
                    'æ™ºæ…§è²¡ç”¢æ¬Šç„¡æ³•ä¿è­·',
                    'å“¡å·¥é›¢è·å¾Œæ´©éœ²å•†æ¥­æ©Ÿå¯†',
                    'ç„¡æ³•è¿½ç©¶æ³•å¾‹è²¬ä»»'
                ],
                measures: [
                    'æ‰€æœ‰æ–°é€²å“¡å·¥å¿…é ˆç°½ç½²ä¿å¯†å”è­°(NDA)',
                    'å®šæœŸæ›´æ–°ä¿å¯†å”è­°å…§å®¹ç¬¦åˆæœ€æ–°æ³•è¦',
                    'é›¢è·æ™‚å†æ¬¡ç¢ºèªä¿å¯†ç¾©å‹™',
                    'å»ºç«‹è³‡è¨Šåˆ†é¡åˆ†ç´šåˆ¶åº¦',
                    'ç‰¹æ®Šè·ä½ç°½ç½²ç«¶æ¥­ç¦æ­¢æ¢æ¬¾',
                    'ä¿ç•™ç°½ç½²è¨˜éŒ„ä¸¦å®šæœŸç¨½æ ¸'
                ],
                severity: 'ä¸­'
            },
            web: {
                keywords: ['ç¶²ç«™', 'æ‡‰ç”¨ç¨‹å¼', 'sql injection', 'xss', 'csrf', 'æ³¨å…¥', 'æ¼æ´æƒæ'],
                iso: ['A.8.25 å®‰å…¨ç™¼å±•ç”Ÿå‘½é€±æœŸ', 'A.8.26 æ‡‰ç”¨ç¨‹å¼å®‰å…¨æ€§è¦æ±‚'],
                risks: [
                    'SQL Injection æ”»æ“Šå°è‡´è³‡æ–™åº«å¤–æ´©',
                    'XSS æ”»æ“Šç«Šå–ä½¿ç”¨è€… Cookie',
                    'æ‡‰ç”¨ç¨‹å¼æ¼æ´è¢«åˆ©ç”¨é€²è¡Œæ”»æ“Š',
                    'å®¢æˆ¶è³‡æ–™èˆ‡å€‹è³‡å¤–æ´©'
                ],
                measures: [
                    'é–‹ç™¼éšæ®µå¯¦æ–½å®‰å…¨ç·¨ç¢¼è¦ç¯„',
                    'å®šæœŸé€²è¡Œç¶²ç«™æ¼æ´æƒæ',
                    'éƒ¨ç½² Web Application Firewall (WAF)',
                    'å¯¦æ–½è¼¸å…¥é©—è­‰èˆ‡è¼¸å‡ºç·¨ç¢¼',
                    'ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢é˜²æ­¢ SQL Injection',
                    'ä¸Šç·šå‰é€²è¡Œæ»²é€æ¸¬è©¦',
                    'å»ºç«‹å®‰å…¨ç™¼å±•ç”Ÿå‘½é€±æœŸ(SDLC)'
                ],
                severity: 'é«˜'
            }
        };

        function analyzeIncident() {
            const incident = searchInput.value.trim();
            const resultsDiv = document.getElementById('results');
            const loadingDiv = document.getElementById('loading');
            const analyzeBtn = document.getElementById('analyzeBtn');

            if (!incident) {
                alert('è«‹è¼¸å…¥è³‡å®‰äº‹ä»¶æè¿°');
                return;
            }

            if (incident.length < 5) {
                alert('è«‹æä¾›æ›´è©³ç´°çš„è³‡å®‰äº‹ä»¶æè¿°ï¼ˆè‡³å°‘5å€‹å­—å…ƒï¼‰');
                return;
            }

            // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
            loadingDiv.style.display = 'block';
            resultsDiv.style.display = 'none';
            analyzeBtn.disabled = true;
            analyzeBtn.textContent = 'ğŸ”„ åˆ†æä¸­...';

            // æ¨¡æ“¬åˆ†æå»¶é²
            setTimeout(() => {
                const analysis = performAnalysis(incident);
                displayResult(incident, analysis);
                
                loadingDiv.style.display = 'none';
                analyzeBtn.disabled = false;
                analyzeBtn.textContent = 'ğŸ” é–‹å§‹åˆ†æ';
            }, 800);
        }

        function performAnalysis(incident) {
            const incidentLower = incident.toLowerCase();
            const matchedCategories = [];
            const matchedKeywords = new Set();

            // é—œéµå­—åŒ¹é…
            for (const [category, data] of Object.entries(knowledgeBase)) {
                let matched = false;
                for (const keyword of data.keywords) {
                    if (incidentLower.includes(keyword)) {
                        matched = true;
                        matchedKeywords.add(keyword);
                    }
                }
                if (matched) {
                    matchedCategories.push({category, data, weight: matchedKeywords.size});
                }
            }

            // å¦‚æœæ²’æœ‰åŒ¹é…ï¼Œè¿”å›é€šç”¨å»ºè­°
            if (matchedCategories.length === 0) {
                return {
                    iso: ['A.5.1 è³‡è¨Šå®‰å…¨æ”¿ç­–', 'A.5.2 è³‡è¨Šå®‰å…¨è§’è‰²åŠè²¬ä»»'],
                    risks: [
                        'æœªè­˜åˆ¥çš„è³‡å®‰é¢¨éšªå¯èƒ½å°è‡´è³‡æ–™å¤–æ´©',
                        'ç¼ºä¹é©ç•¶çš„è³‡å®‰æ§åˆ¶æªæ–½',
                        'å¯èƒ½é•åç›¸é—œæ³•è¦è¦æ±‚',
                        'çµ„ç¹”è³‡å®‰æ…‹å‹¢ä¸æ˜ç¢º'
                    ],
                    measures: [
                        'é€²è¡Œå®Œæ•´çš„è³‡å®‰é¢¨éšªè©•ä¼°',
                        'å»ºç«‹è³‡è¨Šå®‰å…¨ç®¡ç†åˆ¶åº¦(ISMS)',
                        'åˆ¶å®šæ˜ç¢ºçš„è³‡å®‰æ”¿ç­–èˆ‡ç¨‹åº',
                        'å¯¦æ–½è³‡å®‰æ„è­˜è¨“ç·´',
                        'å®šæœŸé€²è¡Œè³‡å®‰ç¨½æ ¸',
                        'è«®è©¢å°ˆæ¥­è³‡å®‰é¡§å•é€²è¡Œæ·±å…¥è©•ä¼°'
                    ],
                    severity: 'ä¸­',
                    severityReason: 'æœªèƒ½è­˜åˆ¥å…·é«”é¢¨éšªé¡åˆ¥ï¼Œå»ºè­°é€²è¡Œå®Œæ•´è©•ä¼°',
                    matchedKeywords: []
                };
            }

            // åˆä½µæ‰€æœ‰åŒ¹é…é¡åˆ¥çš„çµæœ
            const isoSet = new Set();
            const risksSet = new Set();
            const measuresSet = new Set();
            let maxSeverity = 'ä½';

            for (const {data} of matchedCategories) {
                data.iso.forEach(iso => isoSet.add(iso));
                data.risks.forEach(risk => risksSet.add(risk));
                data.measures.forEach(measure => measuresSet.add(measure));
                
                if (data.severity === 'é«˜') maxSeverity = 'é«˜';
                else if (data.severity === 'ä¸­' && maxSeverity !== 'é«˜') maxSeverity = 'ä¸­';
            }

            return {
                iso: Array.from(isoSet),
                risks: Array.from(risksSet).slice(0, 6),
                measures: Array.from(measuresSet).slice(0, 8),
                severity: maxSeverity,
                severityReason: `è­˜åˆ¥åˆ° ${matchedCategories.length} å€‹é¢¨éšªé¡åˆ¥ï¼ŒåŒ…å«é—œéµè³‡å®‰è­°é¡Œ`,
                matchedKeywords: Array.from(matchedKeywords)
            };
        }

        function displayResult(incident, data) {
            const resultsDiv = document.getElementById('results');
            
            const isoHTML = data.iso.map(iso => `<span class="tag">${iso}</span>`).join('');
            const risksHTML = data.risks.map(risk => `<li>${risk}</li>`).join('');
            const measuresHTML = data.measures.map(measure => `<li>${measure}</li>`).join('');
            const keywordsHTML = data.matchedKeywords.map(kw => `<span class="keyword-chip">${kw}</span>`).join('');
            
            let severityClass = 'severity-low';
            if (data.severity === 'é«˜') severityClass = 'severity-high';
            else if (data.severity === 'ä¸­') severityClass = 'severity-medium';

            resultsDiv.innerHTML = `
                <div class="incident-title">
                    ğŸ“‹ ${incident.length > 80 ? incident.substring(0, 80) + '...' : incident}
                    <span class="severity-badge ${severityClass}">${data.severity}é¢¨éšª</span>
                </div>
                
                ${data.matchedKeywords.length > 0 ? `
                <div class="matched-keywords">
                    <strong>ğŸ¯ è­˜åˆ¥é—œéµå­—ï¼š</strong>${keywordsHTML}
                </div>
                ` : ''}
                
                <div class="result-card">
                    <h3>âš–ï¸ å¯èƒ½é•åçš„ ISO 27001 æ¢æ–‡</h3>
                    <div class="result-content">
                        ${isoHTML}
                    </div>
                </div>

                <div class="result-card">
                    <h3>âš ï¸ é¢¨éšªå½±éŸ¿åˆ†æ</h3>
                    <div class="result-content">
                        <p><strong>åš´é‡ç¨‹åº¦è©•ä¼°ï¼š</strong>${data.severityReason}</p>
                        <ul>${risksHTML}</ul>
                    </div>
                </div>

                <div class="result-card">
                    <h3>âœ… å»ºè­°æ”¹å–„æªæ–½</h3>
                    <div class="result-content">
                        <ul>${measuresHTML}</ul>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <p style="color: #666; font-size: 14px;">ğŸ’¡ æ­¤åˆ†æåŸºæ–¼é—œéµå­—æ™ºèƒ½åŒ¹é…ï¼Œå»ºè­°æ­é…å°ˆæ¥­è³‡å®‰é¡§å•é€²è¡Œè©³ç´°è©•ä¼°</p>
                </div>
            `;
            
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    </script>
</body>
</html>